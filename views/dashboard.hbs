<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
  </head>


<!--main-container-part-->
<div id="content">
<!--breadcrumbs-->
  <div id="content-header">
    <div id="breadcrumb"  class=" py-2"> <a href="/dashboard" title="Go to Home" class="tip-bottom"><i class="icon-home"></i> Home</a></div>
  </div>
<!--End-breadcrumbs-->

<!--Action boxes-->
  <div class="container-fluid">
    <div class="quick-actions_homepage">
      <ul class="quick-actions">
        
      </ul>
    </div>
<!--End-Action boxes-->    

<!--Chart-box-->    
    <div class="row-fluid">
      <div class="widget-box">
        <div class="widget-title bg_lg"><span class="icon"><i class="icon-dashboard"></i></span>
          <h5>Dashboard</h5>
        </div>
<!--Chart-box-->

<div class="row">

<div class=" col-sm-6 px-0" >
  <div class="card mt-4">
    <div class="card-header font-weight-bold float-left">
      Online Soldiers
    </div>
    <div class="card-body pt-1">
      <ul class="recent-posts">
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av1.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 1</span> 
          <span class="small pl-5" style="color:green;">Online</span>
          {{!-- <span class="small pl-5" style="color:red;">Offline</span> --}}
            <div class="px-5">
              <span>1</span>
              <span>2</span>
              <span>3</span>
            </div>
          </div>
        </li>
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av2.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 2</span>
          <span class="small pl-5" style="color:green;">Online</span>
          {{!-- <span class="small pl-5" style="color:red;">Offline</span> --}}
            <div class="px-5">
              <span>1</span>
              <span>2</span>
              <span>3</span>
            </div>
          </div>
        </li>
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av2.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 3</span>
          <span class="small pl-5" style="color:red;">Offline</span>
            
            <p>No data Available</p>
          </div>
        </li>
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av2.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 4</span>
          <span class="small pl-5" style="color:red;">Offline</span>
          
            <p>No data Available</p>
          </div>
        </li>
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av2.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 5</span>
          <span class="small pl-5" style="color:red;">Offline</span>
            
            <p>No data Available</p>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class=" col-sm-6"><div id="map"></div></div>
  </div>


<div class="span6">
  <div class="widget-box widget-chat">
    {{!-- <div class="widget-title bg_lb"> <span class="icon"> <i class="icon-comment"></i> </span>
      <h5>Chat Option</h5>
    </div> --}}
    <div class="widget-content nopadding collapse in" id="collapseG4">
      <div class="chat-users panel-right2">
        <div class="panel-title">
          <h5>Online Users</h5>
        </div>
        <div class="panel-content nopadding">
          <ul class="contact-list">
            <li id="user-John" class="online new"><a href=""><img alt="" src="img/demo/av3.jpg" /> <span>Soldier 1</span></a><span
                class="msg-count badge badge-info">3</span></li>
            <li id="user-Alex" class="online"><a href=""><img alt="" src="img/demo/av1.jpg" /> <span>Soldier 2</span></a></li>
            <li id="user-Linda"><a href=""><img alt="" src="img/demo/av2.jpg" /> <span>Soldier 3</span></a></li>
            <li id="user-Mark" class="online"><a href=""><img alt="" src="img/demo/av4.jpg" /> <span>Soldier 4</span></a></li>
            <li id="user-Maxi" class="online"><a href=""><img alt="" src="img/demo/av5.jpg" /> <span>Soldier 5</span></a></li>
          </ul>
        </div>
      </div>
      <div class="chat-content panel-left2">
        <div class="chat-messages" id="chat-messages">
          <div id="chat-messages-inner"></div>
          <div class="span3" style="float:right;
    width:50%;
    height:100px;">
            <ul class="site-stats">
              <li class="bg_lh"><i class="icon-user" id="hb"></i> <strong></strong> <small>HEART BEAT</small></li>
            </ul>
          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="widget-box">
    <div class="widget-title"><span class="icon"><i class="icon-dashboard"></i></span>
      <h5>Activity Base Graph</h5>
    </div>
    <div class="widget-content">
      <div class="ct-chart ct-perfect-fourth"></div>
    </div>
  </div>

  {{!-- <div class="widget-box">
    <div class="widget-title"><span class="icon"><i class="icon-user"></i></span>
      <h5>Message Box</h5>
    </div>
    <div class="widget-content nopadding fix_hgt">
      <ul class="recent-posts">
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av1.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 1</span>
            <p>Soldier 1 has elevated hear rate</p>
          </div>
        </li>
        <li>
          <div class="user-thumb"> <img width="40" height="40" alt="User" src="img/demo/av2.jpg"> </div>
          <div class="article-post"> <span class="user-info">Soldier 2</span>
            <p>Soldier 2 has gone offline</p>
          </div>
        </li>
      </ul>
    </div>
  </div> --}}

</div>
          
     
<script>
  //var getData = $.get('/test');
  //getData.done(function(receivedData){

// Create a new line chart object where as first parameter we pass in a selector
// that is resolving to our chart container element. The Second parameter
// is the actual data object.
var mychart = new Chartist.Line('.ct-chart');

</script>

 <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        position: relative;
        float: right;
        width: 100%;
        height: 600px;
        background-color: #CCC;
    {{!-- margin: 1% 1% 0 0%; --}}
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        width: 100%
        margin: ;
        padding: 0;
      }
    </style>
  
    
    
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDEiIrx7Qjd7K9oL_3-WCIupiKgLgGs5eM&callback=initMap">
    </script>
          
        </div>
      </div>
    </div>
</div>
</div>
<!--End-Chart-box--> 
            

      <!-- Chat option -->


   
<script src="/socket.io/socket.io.js"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

  <script>
    var map;
    function initMap() {

        map = new google.maps.Map(document.getElementById('map'), {
        zoom: 17,
        center: new google.maps.LatLng(24.915, 67.09)
      });
      
    }
      //let tagTest = document.getElementById("tagTest").innerHTML;
      let millis = [-2], series = []
      $(function(){
          var socket = io('http://localhost:3100/somedata');
          socket.on('arduino', function(receivedData){
            if (typeof receivedData["ACC-X"] != "undefined"){
                //console.log(receivedData["ACC-X"]);
            }
            if (typeof receivedData["ACC-Y"] != "undefined"){
              console.log("Acc Y ", receivedData["ACC-Y"]);
              millis.push(millis[millis.length -1]+2);
              series.push(receivedData["ACC-Y"]);
              if (millis.length>=10 && series.length>=10){
                series.shift();
                millis.shift();
              }              
              let data = {labels : millis, series: [series]}
              mychart.update(data, { 
                width : 600,
                height: 450,
                });
            }
                //document.getElementById("acc_y").innerHTML = receivedData["ACC-Y"];
            if (typeof receivedData["ACC-Z"] != "undefined"){}
                //document.getElementById("acc_z").innerHTML = receivedData["ACC-Z"];
            if (typeof receivedData["Alt"] != "undefined"){
              //document.getElementById("alt").innerHTML = receivedData["Alt"];
            }
                
            if (typeof receivedData["HeartBeat"] != "undefined"){
                document.getElementById("hb").innerHTML = receivedData["HeartBeat"];
            }
               
            if (typeof receivedData["GPS"] != "undefined"){
              var marker = new google.maps.Marker({
                position: new google.maps.LatLng(receivedData["GPS"].lat, receivedData["GPS"].long),
                map: map,
                title: 'Muhafiz'
              });
              console.log(receivedData["GPS"] ); 
            }
               
          });
      })
  </script>
  </body>
</html>